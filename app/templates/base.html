{% load static %}
<!doctype html>
<html lang="pt-BR">
<link rel="shortcut icon" type="image/png" href="{% static 'imagem_site/favicon.ico' %}"/>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous"> <!-- BootStrap -->
    <link rel="stylesheet" href="{% static 'usuarios/css/css.css' %}"> <!-- Pasta do projeto CSS -->
    <script src="{% static 'js/scripts.js' %}" defer></script> <!-- Pasta do projeto Scripts do Js -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> <!-- Jquery 2-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script> <!-- BootStrap 3-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- Alertas -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"> <!-- Fonte Icone Sidebar -->
    {% block 'head' %}
    {% endblock %}
    <title>{% block 'title' %} Mercearia Comunitária {% endblock %}</title>
</head>
{% if url_atual != '/login/' and url_atual != '/change_password_first_time/' and url_atual != '/reset/' and url_atual != '/change_password_first_time/' and url_atual != 404 and url_atual != 500 %}
<body class="fundo">
{% else %}
<body class="fundo-login">
    <nav class="navbar navbar-expand-lg navbar-dark">
        <img src="{% static 'imagem_site/aparecida.png' %}" width="40" height="40" class="d-inline-block align-top" alt="">
        <a class="navbar-brand fw-bold mb2 text-uppercase"><font color="RoyalBlue"><strong>&nbspMercearia Comunitária</strong></font></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
    </nav>
{% endif %}
    {% if url_atual != '/login/' and url_atual != '/change_password_first_time/' and url_atual != '/reset/' and url_atual != '/change_password_first_time/' and url_atual != 404 and url_atual != 500 %}
            <div class="sidebar collapsed">
                <div class="logo">
                    <img src="{% static 'imagem_site/aparecida.png' %}" width="40" height="40" alt="Logo">
                    <h5 class="company-name">Mercearia Comunitária</h5>
                    {% if user.cargo == "A" %}
                        <div class="role"><font color="blue"><b>Admin</b></font></div>
                    {% elif user.cargo == "R" %}
                        <div class="role"><font color="blue"><b>Responsável Geral</b></font></div>
                    {% elif user.cargo == "O" %}
                        <div class="role"><font color="blue"><b>Organizador</b></font></div>
                    {% endif %}
                    <p class="username"><b>{{ user.username }}</b></p>
                </div>
                {% if url_atual != '/' %}
                    {% if url_atual == '/cadastrar_comunidade/' or url_atual == '/cadastrar_responsavel/geral' or url_atual == '/alterar_usuarios/' or url_atual == '/comunidades/' or url_atual == '/listar_logs/' or url_atual == '/cadastrogeral_comunidade/' or url_atual == '/add_produto/' or url_atual == '/add_novonome_produto/' or url_atual == '/pre_vendas/' or url_atual == '/consultar_vendas_geral/' or url_atual == '/vendas_finalizadas/' or url_atual == '/cadastrar_organizador/' or url_atual == '/cadastrar_familia/' or url_atual == '/produto/' or url_atual == '/vendas/' or url_atual == '/consultar_vendas/' or url_atual == '/visualizar_vendas/' or url_atual == '/change_password/' or url_atual == '/export_entrada_produtos/' or url_atual == '/visualizar_vendas_finalizadas/' or url_atual == '/consultar_vendas_finalizadas/' or url_atual == '/conferir_vendas_geral/' %}
                        <a href="{% url 'home' %}" class="menu-item"><i class="fas fa-home"></i><span> Home</span></a>
                    {% endif %}

                    {% if url_atual != '/cadastrar_comunidade/' and url_atual != '/cadastrar_responsavel/geral' and url_atual != '/alterar_usuarios/' and url_atual != '/comunidades/' and url_atual != '/listar_logs/' and url_atual != '/change_password/' %}
                        <div class="dropdown">
                            <button class="btn dropdown-toggle menu-item" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-box"></i><span> Estoque</span>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item menu-item" href="{% url 'add_produto' slug %}">Abastecer Estoque</a>
                                <a class="dropdown-item menu-item" href="{% url 'add_novonome_produto' slug %}">Cadastrar Novo Produto</a>
                            </div>
                        </div>
                        <div class="dropdown">
                            <button class="btn dropdown-toggle menu-item" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-shopping-cart"></i><span> Vendas</span>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item menu-item" href="{% url 'pre_vendas' slug %}">Realizar Vendas</a>
                                <a class="dropdown-item menu-item" href="{% url 'consultar_vendas_geral' slug %}">Consultar Vendas Em Andamento</a>
                                <a class="dropdown-item menu-item" href="{% url 'vendas_finalizadas' slug %}">Finalizar Venda</a>
                            </div>
                        </div>
                        {% if user.cargo == "A" or user.cargo == "R" %}
                            <div class="dropdown">
                                <button class="btn dropdown-toggle menu-item" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fas fa-user-plus"></i><span> Usuários</span>
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item menu-item" href="{% url 'cadastrar_organizador' slug %}">Cadastrar Organizador</a>
                                </div>
                            </div>
                        {% endif %}
                        <div class="dropdown">
                            <button class="btn dropdown-toggle menu-item" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-users"></i><span> Famílias</span>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item menu-item" href="{% url 'cadastrar_familia' slug %}">Cadastrar Família</a>
                            </div>
                        </div>
                    {% endif %}

                    {% if url_atual == '/cadastrogeral_comunidade/' or url_atual == '/add_produto/' or url_atual == '/add_novonome_produto/' or url_atual == '/pre_vendas/' or url_atual == '/consultar_vendas_geral/' or url_atual == '/vendas_finalizadas/' or url_atual == '/cadastrar_organizador/' or url_atual == '/cadastrar_familia/' or url_atual == '/produto/' or url_atual == '/vendas/' or url_atual == '/consultar_vendas/' or url_atual == '/visualizar_vendas/' or url_atual == '/export_entrada_produtos/' or url_atual == '/visualizar_vendas_finalizadas/' or url_atual == '/consultar_vendas_finalizadas/' or url_atual == '/conferir_vendas_geral/' %}
                        <a href="{% url 'comunidades' %}" class="menu-item"><i class="fas fa-reply"></i><span> Comunidades</span></a>
                    {% endif %}
                    
                {% endif %}
                <div class="logout-icon">
                    <a href="{% url 'password_reset_login' %}" class="menu-item"><i class="fas fa-lock"></i><span> Alterar Senha<span></a>
                    <a href="{% url 'logout' %}" class="menu-item"><i class="fas fa-sign-out-alt"></i><span> Logout</span></a>
                </div>
            </div>
    {% endif %}

    {% block 'body' %}
    {% endblock %}
    
    <footer class="main-footer">
    </footer>
    {% if messages %} 
        {% for message in messages %}
            <script>//Enviando as mensagens da tela.
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 10000, //10 segundos para sumir
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', () => {
                            Swal.stopTimer(); // Pausar o timer ao passar o mouse sobre a mensagem
                        });
                        toast.addEventListener('mouseleave', () => {
                            Swal.resumeTimer(); // Retomar o timer quando o mouse sair da mensagem
                        });
                    }
                })
                d = '{{message.tags}}'.toLowerCase() //type
                if (d == "alert-danger") {
                    d = 'error'
                }
                if (d == "alert-success") {
                    d = 'success'
                }
                if (d == "alert-info") {
                    d = 'question'
                }
                Toast.fire({
                    icon: d,
                    title: '{{message}}'
                })
            </script>
        {% endfor %}
    {% endif %}

    <script src="{% static 'js/jquery-3.7.0.min.js' %}"></script> <!-- Jquery -->
    <script src="{% static 'js/jquery.mask.min.js' %}"></script> <!-- Jquery Mascara para campos -->

    {% block scripts %}
    
    {% endblock %}
</body>
</html>
